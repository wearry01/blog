<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">

<link rel="stylesheet" href="/css/justifiedGallery.min.css" />

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="/js/jquery.justifiedGallery.min.js"></script>

<title>平面树计数 | Wearry&#39;s Blog</title>


<link rel="stylesheet" href="/assets/combined.min.e962532feeb5740101e74674a3b76810a4b11df3e73378622fd233e3e9f06c82.css" media="all">




<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],
      inlineMath: [['\\[', '\\]'], ['$', '$'], ['\\(', '\\)']]
    }
  };
</script>





</head>







<body class="auto">

  <div class="content">
    <header>
      

<div class="header">
    <h1 class="header-title">Wearry&#39;s Blog</h1>
    <h3 class="header-subtitle">长恨此身非我有</h3>

    <div class="flex">
        

        
        
        <p class="small ">
            <a href="/">
                /home
            </a>
        </p>
        
        <p class="small ">
            <a href="/posts">
                /posts
            </a>
        </p>
        
        <p class="small ">
            <a href="/photos">
                /photos
            </a>
        </p>
        
        
    </div>

</div>

    </header>

    <main class="main">
      



<div >

  <div class=" single-intro-container">

    

    <h1 class="single-title">平面树计数</h1>
    <p class="single-summary">不常见的经典问题, 顺便总结一下Burnside引理吧</p>

    

    

    <p class="single-readtime">
      
      
      
      <time datetime="2017-12-01T11:03:04&#43;00:00">Dec 01, 2017 11:03</time>
      
      
    </p>

  </div>

  

  
  <aside class="toc">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#问题描述">问题描述</a></li>
    <li><a href="#做法">做法</a></li>
  </ul>
</nav>
  </aside>
  

  

  <div class="single-content">
    <h2 id="问题描述">问题描述</h2>
<blockquote>
<p>给定 \(N\), 求 \(N\) 个点的本质不同的平面树的数量.</p>
<p>两棵平面树是等价的当且仅当其中一棵能够移动点的位置与另一棵重合, 且过程中仍然是一棵平面树——即在平面内边不交错地进行平移.</p>
</blockquote>
<h2 id="做法">做法</h2>
<p>考虑模型转化 (计算 \(N+1\) 个点的答案):
取单位圆, 等距地取 \(2N\) 个点, 然后将这些点两两配对连边, 满足所有连边不相交.
发现它的对偶图恰好是一棵平面树, 像这样:</p>
<figure><img src="/images/plane-tree.png">
</figure>

<p>那么就只需要考虑本质不同的这样的配对的数量即可.
两个圆是等价的当且仅当一个圆可以通过旋转一定的角度与另一个圆重合.
而在这个圆上共有 \(2N\) 个点, 就意味着有 \(2N\) 个置换, 构成一个置换群.</p>
<p>置换群下的计数可以用到 Burnside引理 :</p>
<blockquote>
<p>$$ N(G, C) = \frac{1}{|G|} { \sum_{f \in G} c(f) } $$</p>
</blockquote>
<p>则转化为求置换下的不动点的数量:</p>
<ul>
<li>
<p>不存在置换的情况下, 答案为 Catalan 数的第 \(N\) 项 \(C_N\).
即将相互匹配的位置看作左右括号, 则所有合法的括号序列都对应一个满足条件的圆.</p>
</li>
<li>
<p>\(N\) 为奇数时, 可能存在一条平分圆的对角线在置换下不变, 计算 \(\frac{N+1}{2}\) 个点的答案即可.</p>
</li>
<li>
<p>考虑旋转置换:</p>
<p>为了满足旋转之后的边重合, 点 \(i\) 和它的匹配点 \(p_i\) 在旋转后应该仍然是相匹配的.
则环的数量一定是偶数 \(2d\), 所以环的长度可以表示为 \(\frac{2N}{2d} = \frac{N}{d}\).</p>
<p>假定置换的阶是 \(e\), \(e &gt; 1, e | N\), 环的数量 \(2d = \frac{2N}{e}\).
环上与 \(0\) 匹配的点为 \(i\), 不难发现在这些点之间的点的方案数为 \(C_{i-1}\).
当这些点确定之后, 它们在环上依次经过的 \(e(i+1)\) 个点就确定了.</p>
</li>
</ul>
<p>令 \(f(x)\) 表示 Catalan 数的生成函数, 根据 Catalan 数的递推式得到:</p>
<p>$$ f(x) = xf^2(x) + 1 $$</p>
<p>构造 \(B_d\) 表示包含 \(2d\) 个环的置换下不动点的数量.</p>
<p>$$ B_d = 2\sum_{i = 0}^{d-1} C_i B_{d-i-1} $$</p>
<p>其中因子 \(2\) 考虑的是 \(i &gt; 2d\) 时用当前置换的逆来计算的情况.</p>
<p>则 \(B_d\) 的生成函数 \(g(x)\) 满足:</p>
<p>$$ g(x) = 2x g(x) f(x) + 1 $$</p>
<p>解得:</p>
<p>$$ g(x) = (1 - 4x) ^ {-\frac{1}{2}} $$</p>
<p>于是总的生成函数可以写成:</p>
<p>$$ p(n) = \frac{1}{2n} \left( [\mathrm{n , is , odd}]\binom{n}{\lfloor\frac{n}{2}\rfloor} - \binom{2n}{n-1} + \sum_{d|n}{\varphi(n/d)\binom {2d}{d}} \right)$$</p>

  </div>

</div>


    </main>
  </div>

  <footer>
    <p>Powered by
<a href="https://gohugo.io/">Hugo</a>
and
<a href="https://github.com/tomfran/typo">tomfran/typo</a>
© Wearry >_ 2024 
</p>

<script id="gallery-script" src="/js/gallery.js"></script>

  </footer>

</body>


<script>

  function isAuto() {
    return document.body.classList.contains("auto");
  }

  function setTheme() {
    if (!isAuto()) {
      return
    }

    console
    document.body.classList.remove("auto");
    let cls = "light";

    console.log

    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      cls = "dark";
    }

    document.body.classList.add(cls);

  }

  function invert() {
    document.body.classList.toggle("dark");
    document.body.classList.toggle("light");
  }

  if (isAuto()) {
    console.log("Setting invert listener");
    window.matchMedia('(prefers-color-scheme: dark)').addListener(invert);
  }

  setTheme();

</script>


</html>